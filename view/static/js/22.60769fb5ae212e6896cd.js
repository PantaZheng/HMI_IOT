webpackJsonp([22],{"7mxR":function(t,e){},"80Fw":function(t,e){},IaHk:function(t,e){},PdSR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"checkTaskHeader",data:function(){return{taskName:sessionStorage.getItem("taskName")}}},a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header"},[e("div",{staticClass:"header-left back-icon"},[e("router-link",{attrs:{to:"/check"}},[e("svg",{staticClass:"icon arrow",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#iconleft"}})])])],1),this._v(" "),e("div",{staticClass:"header-title v-center"},[this._v("\n    "+this._s(this.taskName)+"\n  ")]),this._v(" "),e("div",{staticClass:"header-right"})])},staticRenderFns:[]};var l=i("VU/8")(s,a,!1,function(t){i("IaHk")},"data-v-1138b885",null).exports,n=i("OMN4"),o=i.n(n),r={name:"checkProjectDetailForm",data:function(){return{chooseMissionId:"",taskState:"",projectID:"",task:"",okTask:!1,addMission:!1,editMission:!1,deleteMission:!1,studentList:[],projectName:"",name:"",startTime:"",endTime:"",content:"",target:"",leaderName:"",mission:{name:"",moduleID:parseInt(sessionStorage.getItem("taskID")),startTime:"",endTime:"",ownerID:"",content:"",target:""},editMissionForm:{name:"",moduleID:parseInt(sessionStorage.getItem("taskID")),startTime:"",endTime:"",ownerID:"",content:"",target:""},missionList:[{name:"",moduleID:parseInt(sessionStorage.getItem("taskID")),startTime:"",endTime:"",ownerID:"",content:"",target:""}]}},methods:{handleAddMission:function(){this.getStudentList(),this.mission.name="",this.mission.startTime="",this.mission.endTime="",this.mission.content="",this.mission.target="",this.mission.ownerID=-1,this.addMission=!0},getTask:function(){o.a.get(this.url+"/module/id/"+sessionStorage.getItem("taskID")).then(this.getTaskSucc)},getTaskSucc:function(t){(t=t.data)&&(this.task=t,this.name=t.name,this.startTime=t.startTime,this.endTime=t.endTime,this.content=t.content,this.target=t.target,this.leaderName=t.leaderName,this.projectName=t.projectName,this.projectID=t.projectID,this.getProjectState(t.projectID))},getMissionSucc:function(t){200===t.status?(t=t.data,this.editMissionForm=t,this.editMissionForm.state=t.state,this.editMission=!0):alert(t.data)},getMissionList:function(){o.a.get(this.url+"/mission/module/"+sessionStorage.getItem("taskID")).then(this.getMissionListSucc)},getMissionListSucc:function(t){(t=t.data)&&(this.missionList=t)},getStudentList:function(){o.a.get(this.url+"/user/level/2").then(this.getStudentListSucc)},getStudentListSucc:function(t){console.log("getStudentListSucc"),200===t.status&&(t=t.data,this.studentList=t,console.log(this.studentList))},submitMission:function(){var t=this;-1!==this.mission.ownerID?""!==this.mission.name?this.mission.name.length>10?this.$notify.warning({title:"任务名称不能超过十个字！"}):(this.$axios({method:"post",url:this.url+"/mission/",data:this.mission}).then(function(e){200===e.status?(alert("提交成功！"),t.getMissionList()):alert("提交失败！请重新打开页面")}).catch(function(t){alert(t)}),this.addMission=!1):this.$notify.warning({title:"请输入任务名称！"}):this.$notify.warning({title:"请选择任务负责人！"})},updateMission:function(){-1!==this.editMissionForm.ownerID?""!==this.editMissionForm.name?(this.$axios({method:"put",url:this.url+"/mission/",data:this.editMissionForm}).then(function(t){200===t.status?alert("提交成功！"):alert(t.data)}).catch(function(t){alert(t)}),this.editMission=!1):this.$notify.warning({title:"请输入任务名称！"}):this.$notify.warning({title:"请选择任务负责人！"})},submit:function(){var t=this;this.$axios({method:"put",url:this.url+"/module/",data:{id:parseInt(sessionStorage.getItem("taskID")),state:parseInt(this.taskState),leaderID:this.task.leaderID,name:this.name,startTime:this.startTime,endTime:this.endTime,content:this.content,target:this.target}}).then(function(e){200===e.status?alert("提交成功！"):alert("提交失败！请重新打开页面"),t.okTask=!1,t.$router.push("/check")}).catch(function(t){alert(t)})},getProjectState:function(t){console.log("pid"+t),o.a.get(this.url+"/project/id/"+t).then(this.getProjectStateSucc)},getProjectStateSucc:function(t){200===t.status&&((t=t.data).state===this.Run?this.taskState=this.Run:this.taskState=this.ProjectWaitForCheck)},delMission:function(t){var e=this;this.$axios({method:"delete",url:this.url+"/mission/id/"+t}).then(function(i){200===i.status&&(alert("删除成功！"),e.chooseOperation=!1,o.a.get(e.url+"/mission/module"+t).then(e.getMissionListSucc),e.getMissionList())}).catch(function(t){alert(t)})},handleEditMission:function(t){this.editMission=!0,o.a.get(this.url+"/mission/id/"+t).then(this.getMissionSucc)}},mounted:function(){this.getTask(),this.getMissionList(),this.getStudentList()}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-bg"},[i("el-divider"),t._v(" "),i("div",{staticClass:"weui-cell"},[t._m(0),t._v(" "),i("div",{staticClass:"weui-cell__bd cellMargin"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[t._v("\n        "+t._s(t.projectName)+"\n      ")])])]),t._v(" "),i("div",{staticClass:"weui-cell"},[t._m(1),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.startTime,expression:"startTime"}],staticClass:"weui_input",attrs:{type:"date",disabled:""},domProps:{value:t.startTime},on:{input:function(e){e.target.composing||(t.startTime=e.target.value)}}})])])])]),t._v(" "),i("div",{staticClass:"weui-cell"},[t._m(2),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.endTime,expression:"endTime"}],staticClass:"weui_input",attrs:{type:"date",disabled:""},domProps:{value:t.endTime},on:{input:function(e){e.target.composing||(t.endTime=e.target.value)}}})])])])]),t._v(" "),i("div",{staticClass:"weui-cell"},[t._m(3),t._v(" "),i("div",{staticClass:"weui-cell__bd cellMargin"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[t._v("\n        "+t._s(t.leaderName)+"\n      ")])])]),t._v(" "),i("div",{staticClass:"weui-cell weui-cells_form"},[t._m(4),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入课题主要内容",disabled:"",clearable:""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),i("div",{staticClass:"weui-cell weui-cells_form"},[t._m(5),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入课题考核指标",disabled:"",clearable:""},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}})],1),t._v(" "),i("el-divider"),t._v(" "),i("div",{staticClass:"row"},[i("svg",{staticClass:"icon addTaskIcon",attrs:{"aria-hidden":"true"},on:{click:t.handleAddMission}},[i("use",{attrs:{"xlink:href":"#iconicon_add"}})]),t._v(" "),i("span",{staticClass:"v-center"},[i("svg",{staticClass:"icon taskIcon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#iconrenwu1"}})]),t._v("\n        任务安排\n      ")])]),t._v(" "),i("el-divider"),t._v(" "),t._l(t.missionList,function(e){return i("div",{key:e.id},[i("div",{staticClass:"row"},[i("span",{staticClass:"taskName"},[i("svg",{staticClass:"icon projectIcon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icondian3"}})]),t._v("\n          "+t._s(e.name)+"\n        ")]),t._v(" "),i("span",{staticClass:"delIcon"},[i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(i){return t.handleEditMission(e.id)}}}),t._v(" "),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(i){return t.delMission(e.id)}}})],1)]),t._v(" "),i("el-divider")],1)}),t._v(" "),i("el-dialog",{attrs:{title:"新建任务",visible:t.addMission,width:"90%"},on:{"update:visible":function(e){t.addMission=e}}},[i("div",{staticClass:"weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("任务名称")])]),t._v(" "),i("div",{staticClass:"weui-cell__bd "},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.mission.name,expression:"mission.name"}],staticClass:"weui-input",attrs:{placeholder:"请输入任务名称",type:"name"},domProps:{value:t.mission.name},on:{input:function(e){e.target.composing||t.$set(t.mission,"name",e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("开始时间")])]),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.mission.startTime,expression:"mission.startTime"}],staticClass:"weui_input",attrs:{type:"date",value:""},domProps:{value:t.mission.startTime},on:{input:function(e){e.target.composing||t.$set(t.mission,"startTime",e.target.value)}}})])])]),t._v(" "),i("div",{staticClass:"weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("结束时间")])]),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.mission.endTime,expression:"mission.endTime"}],staticClass:"weui_input",attrs:{type:"date",value:""},domProps:{value:t.mission.endTime},on:{input:function(e){e.target.composing||t.$set(t.mission,"endTime",e.target.value)}}})])])]),t._v(" "),i("div",{staticClass:"weui_cell weui_cell_select"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.mission.ownerID,expression:"mission.ownerID"}],staticClass:"weui_select",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.mission,"ownerID",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:"-1"}},[t._v("请选择任务负责人")]),t._v(" "),t._l(t.studentList,function(t){return i("option",{key:t.id,attrs:{label:t.name},domProps:{value:t.id}})})],2)])]),t._v(" "),i("div",{staticClass:"weui-cell weui-cells_form"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("任务主要内容")])]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入任务主要内容",clearable:""},model:{value:t.mission.content,callback:function(e){t.$set(t.mission,"content",e)},expression:"mission.content"}})],1),t._v(" "),i("div",{staticClass:"weui-cell weui-cells_form"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("任务考核指标")])]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入任务考核指标",clearable:""},model:{value:t.mission.target,callback:function(e){t.$set(t.mission,"target",e)},expression:"mission.target"}})],1),t._v(" "),i("el-divider"),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.addMission=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitMission()}}},[t._v("提交")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改任务",visible:t.editMission,width:"90%"},on:{"update:visible":function(e){t.editMission=e}}},[i("div",{staticClass:"weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("任务名称")])]),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editMissionForm.name,expression:"editMissionForm.name"}],staticClass:"weui-input",attrs:{pattern:"[0-9]*",placeholder:"请输入任务名称",type:"name"},domProps:{value:t.editMissionForm.name},on:{input:function(e){e.target.composing||t.$set(t.editMissionForm,"name",e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("开始时间")])]),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editMissionForm.startTime,expression:"editMissionForm.startTime"}],staticClass:"weui_input",attrs:{type:"date",value:""},domProps:{value:t.editMissionForm.startTime},on:{input:function(e){e.target.composing||t.$set(t.editMissionForm,"startTime",e.target.value)}}})])])]),t._v(" "),i("div",{staticClass:"weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("结束时间")])]),t._v(" "),i("div",{staticClass:"weui-cell__bd"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editMissionForm.endTime,expression:"editMissionForm.endTime"}],staticClass:"weui_input",attrs:{type:"date",value:""},domProps:{value:t.editMissionForm.endTime},on:{input:function(e){e.target.composing||t.$set(t.editMissionForm,"endTime",e.target.value)}}})])])]),t._v(" "),i("div",{staticClass:"weui_cell weui_cell_select"},[i("div",{staticClass:"weui_cell_bd weui_cell_primary"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.editMissionForm.ownerID,expression:"editMissionForm.ownerID"}],staticClass:"weui_select",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.editMissionForm,"ownerID",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:"-1"}},[t._v("请选择任务负责人")]),t._v(" "),t._l(t.studentList,function(t){return i("option",{key:t.id,attrs:{label:t.name},domProps:{value:t.id}})})],2)])]),t._v(" "),i("div",{staticClass:"weui-cell weui-cells_form"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("任务主要内容")])]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入任务主要内容",clearable:""},model:{value:t.editMissionForm.content,callback:function(e){t.$set(t.editMissionForm,"content",e)},expression:"editMissionForm.content"}})],1),t._v(" "),i("div",{staticClass:"weui-cell weui-cells_form"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label"},[t._v("任务考核指标")])]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入任务考核指标",clearable:""},model:{value:t.editMissionForm.target,callback:function(e){t.$set(t.editMissionForm,"target",e)},expression:"editMissionForm.target"}})],1),t._v(" "),i("el-divider"),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editMission=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateMission()}}},[t._v("提交修改")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"提示",visible:t.okTask,width:"70%"},on:{"update:visible":function(e){t.okTask=e}}},[i("span",[t._v("确定提交《"+t._s(t.name)+"》的审核吗？")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.okTask=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("label",{staticClass:"weui-label"},[this._v("所属项目")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("label",{staticClass:"weui-label"},[this._v("开始时间")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("label",{staticClass:"weui-label"},[this._v("结束时间")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("label",{staticClass:"weui-label"},[this._v("课题负责人")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("label",{staticClass:"weui-label"},[this._v("主要内容")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"weui-cell__hd"},[e("label",{staticClass:"weui-label"},[this._v("考核指标")])])}]};var d=i("VU/8")(r,c,!1,function(t){i("7mxR")},"data-v-0bf83542",null).exports,u={name:"taskDetail",components:{TaskDetailHeader:l,TaskDetailForm:d}},m={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("task-detail-header"),this._v(" "),e("task-detail-form")],1)},staticRenderFns:[]};var v=i("VU/8")(u,m,!1,function(t){i("80Fw")},"data-v-2e43b52c",null);e.default=v.exports}});
//# sourceMappingURL=22.60769fb5ae212e6896cd.js.map